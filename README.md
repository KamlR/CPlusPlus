# Контрольное домашнее задание по прикладным методам математической статистики
## Работа выполнена Мавлетовой Кариной Радиковной (БПИ216) и Краснослободцевым Кирилом Дмитриевичем (БПИ218)
## Вариант 2:

### Встпуление:
В нашей работе мы проанализировали данные о бывших заключённых, опираясь на задания варианта номер 2. В качестве инструмента для анализа данных был использован язык Python.
Были использованы следующие библиотеки:
```
import numpy as np
import pandas as pd
from sklearn.linear_model import LinearRegression
from sklearn.linear_model import LogisticRegression
import statsmodels.api as sm
from sklearn.metrics import mean_squared_error
from scipy import stats
%matplotlib inline
import matplotlib.pyplot as plt
```
Для выполнения задания мы выбрали следующие переменные:
```
recid – объясняемая переменная
age, black, married, drugs, rules - регрессоры
```
Как мы подготовили данные для анализа:
- Считали датасет для 2 варианта
- Удалили столбцы alcohol, educ, felon
- Создали выборку, убрав последние 50 наблюдений, так как для них не надо значение recid по условию. Чуть позже для пункта 8 мы их вернули.

Получили следующую таблицу:

![photo_2023-06-02_15-32-43](https://github.com/KamlR/CPlusPlus/assets/115434090/75b594ee-82c6-4183-ae6c-042edace90b5)
### Вопрос 6: 
Для каждого пункта ниже мы выделили отдельно зависимые и независимые переменные и, используя функции Python получили свободный член и коэффициенты для каждой из 3 моделей.
#### :white_check_mark:Оцените линейную модель, связывающую вероятность повторного преступления с остальными признаками:
![photo_2023-06-02_15-52-27](https://github.com/KamlR/CPlusPlus/assets/115434090/1e79b01f-3d76-4a68-8e4a-81ec6c8a7592)

#### :white_check_mark:Оцените логит модель, связывающую вероятность повторного преступления с остальными признаками:
![photo_2023-06-02_15-53-27](https://github.com/KamlR/CPlusPlus/assets/115434090/f7a12a7e-c9e5-4725-9c04-dd6d762b7551)

#### :white_check_mark:Оцените пробит модель, связывающую вероятность повторного преступления с остальными признаками:
![photo_2023-06-02_15-53-55](https://github.com/KamlR/CPlusPlus/assets/115434090/71f9c76d-5ceb-476a-9a58-254146b50f0d)

#### Вывод:
В ходе выполнения 6 задания были получены оценочные коэффициенты для 3 моделей регрессии.

### Вопрос 7:
#### :white_check_mark:Дайте словесное описание полученных результатов на примере probit-модели. Какие из переменных получились значимыми? 
Ниже отдельно опишем, как каждый коэффициент повлиял на значимость переменной.
Для начала заметим, что MSE равна 0.227, это показывает, что прогнозные значения несильно отличаются от фактических. Теперь опишем, что показывают значение полученных коэффициентов:
Ниже для удобства имена соответствуют коэффициентам при переменных с соотв. названиями.
- black = 0.325683 делает переменную значимой и показывает, что люди с тёмным цветом кожи с большой вероятностью пойдут на повторное преступление.
- drugs = 0.199177 - также делает переменную значимой  и показывает, что люди, имеющие проблемы с наркотиками, способны совершить повторное преступление. Однако, этот фактор менее значим, чем пред.
- rules = 0.069656 очень слабо влияет на вероятность того, что человек пойдёт на повторное преступление.
- age = -0.000482, т.е. переменная также является значимой и показывает, что чем старше человек, тем с меньшей вероятностью он совершает повторное преступление.
- married = -0.174069 делает переменную значимой и уменьшает вероятность совершения повторного преступления.

#### :white_check_mark:Выпишите оцененную ковариационную матрицу оценок коэффициентов
<img width="605" alt="image" src="https://github.com/KamlR/CPlusPlus/assets/115434090/0d3bb793-d715-4104-86db-8da54999baaa">

#### Вывод:
Таким образом, используя данные из 6 пункта, мы объяснили, как каждый коэффициент влияет на значимость соотв. переменной. Выяснилось, что каждая переменная, анализируемая нами, оказалось значимой.
Также мы получили оцененную ковариационную матрицу оценок коэффициентов.

### Вопрос 8:
В данном пункте цель следующая: по уже известным коэффициентам для каждой модели расчитать вероятность совершения повторного пресупления и сравнить полученные результаты с имеющмися в таблице.
Ниже будут представлены таблицы с полученными вероятностями.
#### :white_check_mark: Оцените вероятность повторного преступления для всех наблюдений, включая 50 последних (где неизвестно значение recid) для линейной модели.
![photo_2023-06-02_16-39-02](https://github.com/KamlR/CPlusPlus/assets/115434090/9762d37a-1ef0-465b-a36c-319d69d0dc27)

#### :white_check_mark: Оцените вероятность повторного преступления для всех наблюдений, включая 50 последних (где неизвестно значение recid) для логит модели.
![photo_2023-06-02_16-42-01](https://github.com/KamlR/CPlusPlus/assets/115434090/a8c298db-b8aa-42a6-8add-d7fe1023152b)

#### :white_check_mark: Оцените вероятность повторного преступления для всех наблюдений, включая 50 последних (где неизвестно значение recid) для пробит модели.
![photo_2023-06-02_16-43-33](https://github.com/KamlR/CPlusPlus/assets/115434090/07e9e648-5fbf-467e-a61a-b718b37d9102)

#### :white_check_mark:Есть ли заметные различия между прогнозируемыми вероятностями?
Ниже представлена таблица, в которой указаны различия между прогнозируемыми вероятностями соотв. моделей.
Считали мы их след. образом:
- брали две модели
- получали квадрат разницы между соотв. значениями
- складывали значения из прошлого пункта
- полученную сумму делили на общее количетство наблюдений

![photo_2023-06-02_16-51-17](https://github.com/KamlR/CPlusPlus/assets/115434090/ea42d4aa-7bcf-409e-8477-3f6cf1a2b315)

#### :white_check_mark:В каких наблюдениях возникают наибольшие расхождения? 
Смотря на таблицу выше, можно с уверенностью сказать, что наибольшие расхождения возникают между 1 и 2 моделями.

#### :white_check_mark: Кому из ещё не совершивших рецидива бывших заключенных требуется уделить особое внимание?
Это мы выяснили следующим образом:
- Используя коэффициенты, посчитанные в 6 пункте, оценили вероятность совершения повторного преступления для последних 50 заключённых.
Ниже представлена таблица номеров заключённых, на которых следует обратить особое внимание. Т.е они в теории с большей вероятностью относительно дргуих (берём 50 последних) могут пойти на повторное преступление.
![photo_2023-06-02_17-03-51](https://github.com/KamlR/CPlusPlus/assets/115434090/22cbd735-e842-4e0c-8e80-1b978567afc3)

#### Вывод:
В данном пункте, используя ранее посчитанные коэффициенты - мы рассчитали для каждой модели вероятности совершения повторного преступления. Далее мы сравнили полученные результаты и выяснили, что наибольшие расхождения в значениях вероятснотей имеют 1 и 2 модели.
Также мы выяснили, что на 9/50 заключённых с конца нужно обратить особое внимание, так как по полученным вероятностям они могут пойти на повторное преступление.

### Вопрос 9:
Значимость модели позволяет нам понять, насколько её параметры верно описывают зависимую переменную. Обратим внимание на то, что в нашей текущей модели нет коэффициентов, которые отвечают за алкоголь, образование и тяжесть ранее совершённого преступления.
Так вот, нам предстоит понять, насколько хорошо модель может предсказывать результат без этих данных.
#### :white_check_mark: На примере probit модели проверьте значимость модели в целом тестом отношения правдоподобия:
- Мы взяли коэффициенты UR-модели(где есть все коэфф):
![photo_2023-06-02_17-25-24](https://github.com/KamlR/CPlusPlus/assets/115434090/dcdd51d2-e159-4175-a4ef-3a4157be6b34)
- Также взяли коэффициенты R-модели:
![photo_2023-06-02_17-26-34](https://github.com/KamlR/CPlusPlus/assets/115434090/715e230d-a74d-416b-bc02-380c1938c980)
- Далее применяя функции Python, провели тест отношения правдободобия
![photo_2023-06-02_17-31-18](https://github.com/KamlR/CPlusPlus/assets/115434090/bae3a7de-316e-4b1a-a854-7580c8b4ad67)
Какой можно сделать вывод на основе полученного значения?
Прежде всего скажем о том, что у нас есть на данный момент две 
